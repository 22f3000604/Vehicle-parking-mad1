{% extends "base.html" %}

{% block head %}
<h1 class="first">Quick Park</h1>
{% endblock %}

{% block body %}

<div >

<h2>Welcome, {{ user.name }}</h2>
</div>
<div class="button-right">

    <a href="{{ url_for('logout') }} "> <button class = "button">Logout</button>
    </button>
    <a href="{{ url_for('summary') }}"> <button class="button">Summary</button></a>
    <a href="{{ url_for('editprofile')}}"> <button class="button">Edit</button></a>
    </div>
    
    <div class="dashboard-content">

        <!-- Available Parking Lots Table -->
        <section class="booking-section">
            <h3>Available Parking Lots</h3>
            <table>
                <thead>
                    <tr>
                        <th>Lot</th>
                        <th>Address</th>
                        <th>Price</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for lot in parking_lots %}
                    <tr>
                        <td>{{ lot.prime_location_name }}</td>
                        <td>{{ lot.address }}</td>
                        <td>{{ lot.price }}</td>
                        <td>
                            <a href="{{ url_for('book_lot', lot_id=lot.id) }}" class="btn">Book Now</a>
                        </td>
                    </tr>
                    {% else %}
                    <tr>
                        <td colspan="4">No parking lots available at the moment.</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>

        <section class="history-section">
            <h3>Your Booked Lots</h3>
            {% if reservations %}
                <table>
                    <thead>
                        <tr>
                            <th>Lot Name</th>
                            <th>Address</th>
                            <th>Spot ID</th>
                            <th>Start Time</th>
                            <th>End Time</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for reservation in reservations %}
                        <tr>
                            <td>{{ reservation.parking_spot.parking_lot.prime_location_name }}</td>
                            <td>{{ reservation.parking_spot.parking_lot.address }}</td>
                            <td>{{ reservation.spot_id }}</td>
                            <td>{{ reservation.parking_timestamp }}</td>
                            <td>{{ reservation.leaving_timestamp or "Active" }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No booked lots yet.</p>
            {% endif %}
        </section>
{% endblock %}